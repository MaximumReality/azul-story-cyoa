<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Chat with Azul & Mochkil üê±üêà‚Äç‚¨õ</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
body { font-family:'Press Start 2P', monospace; background:linear-gradient(to bottom,#0a0a0a,#111); color:#f0f0f0; padding:2rem; margin:0; min-height:100vh; }
h1 {color:#39ff14;text-shadow:0 0 10px #39ff14;text-align:center;margin-bottom:0.5rem;}
p {text-align:center;color:#aaa;margin-bottom:2rem;}
#chatContainer {max-width:700px;margin:0 auto 2rem;display:flex;flex-direction:column;gap:1rem;}
input[type="text"] {font-family:monospace;font-size:1rem;padding:0.5rem;border-radius:5px;border:none;width:100%;box-sizing:border-box;}
button {font-family:monospace;font-size:1rem;padding:0.5rem 1rem;margin-top:0.5rem;background:#222;color:#39ff14;border:2px solid #39ff14;border-radius:5px;cursor:pointer;transition:0.2s;}
button:hover {background:#39ff14;color:#000;}
#responses {margin-top:1rem;display:flex;flex-direction:column-reverse;gap:1rem;}
.response {padding:0.5rem 1rem;border-radius:10px;background:#111;box-shadow:0 0 10px #39ff14;animation:fadeIn 0.5s;}
.response strong {color:#39ff14;}
img.character {width:40px;vertical-align:middle;margin-right:0.5rem;}
#typingIndicator {text-align:center;font-style:italic;color:#39ff14;display:none;}
@keyframes fadeIn {from {opacity:0; transform:translateY(10px);} to {opacity:1; transform:translateY(0);}}
body::before {content:"üêæ";position:fixed;font-size:3rem;top:50%;left:50%;transform:translate(-50%,-50%) rotate(45deg);opacity:0.03;pointer-events:none;}
video {display:none;margin:1rem auto;max-width:90%;border:3px solid #39ff14;border-radius:10px;box-shadow:0 0 20px #39ff14;}
</style>
</head>
<body>

<h1>Chat with Azul & Mochkil üê±üêà‚Äç‚¨õ</h1>
<p>Ask a question or start an adventure!</p>

<div id="chatContainer">
  <input type="text" id="promptInput" placeholder="Type your story prompt here...">
  <div>
    <button onclick="addResponse()">Send</button>
    <button onclick="randomPrompt()">üé≤ Random Prompt</button>
  </div>
  <div id="typingIndicator">üí¨ Azul & Mochkil are thinking...</div>
</div>

<div id="responses"></div>

<h2>Unlocked Adventures</h2>
<div id="videosContainer"></div>

<script>
// Character responses
const azulReplies=["Oh, sure‚Ä¶ like I haven‚Äôt seen this before üòè","Adventure calls! Hope you can keep up üöÄ","Sarcastic comment loaded‚Ä¶ but I‚Äôll save it for the dramatic moment üòé","Hacking the scammers again‚Ä¶ you‚Äôre welcome üíª","Floating upside-down because walking is boring üåÄ","Keep your eyes peeled ‚Äî surprises ahead ‚ú®","Bet you didn‚Äôt expect THAT in Maximum Reality! üß™"];
const mochkilReplies=["Is it snack time yet? üç™","I‚Äôll eat everything in sight‚Ä¶ maybe later üòã","Bored‚Ä¶ let‚Äôs play ninjas! ü•∑üèª","Oops! Did I break something again? üôÉ","Food‚Ä¶ everywhere‚Ä¶ my dream world üç©","Can I eat that? Can I? Can I? üêü","Wait‚Ä¶ what are we doing? Oh cool! üêæ"];

// Random prompts
const randomPrompts=["What is Mochkil dreaming today? üç™","What hack is Azul working on? üß™","What's happening in Maximum Reality right now? üåå","Pirates Adventure! üè¥‚Äç‚ò†Ô∏è","Space voyage time! üöÄ"];

// Typing indicator
const typingIndicator=document.getElementById('typingIndicator');
let typingInterval;
function showTypingIndicator(show){
  if(show){
    typingIndicator.style.display='block';
    let visible=true;
    typingInterval=setInterval(()=>{typingIndicator.style.opacity=visible?'1':'0.3';visible=!visible;},500);
  }else{
    typingIndicator.style.display='none';
    clearInterval(typingInterval);
  }
}

// Story state
let currentStory=null;
let currentNode=null;
const videosContainer=document.getElementById('videosContainer');

// Story nodes
const stories={
  taco:{
    start:{text:"üåÆ A taco truck appears. What do you do?",choices:[{label:"Try to order yourself",next:"youOrder"},{label:"Let Mochkil order",next:"mochkilOrders"}]},
    youOrder:{text:"Azul: Spanish is required! üç¥",end:true,unlock:"azul_mochkil_taco_truck.mp4"},
    mochkilOrders:{text:"Mochkil confidently orders a chicken taco. üåÆ",end:true,unlock:"azul_mochkil_taco_truck.mp4"}
  },
  pirate:{
    start:{text:"üè¥‚Äç‚ò†Ô∏è You see a pirate ship! What do you do?",choices:[{label:"Board the ship",next:"board"},{label:"Sneak aboard",next:"sneak"}]},
    board:{text:"You boldly board the ship. ‚ò†Ô∏è",end:true,unlock:"azul_mochkil_pirates.mp4"},
    sneak:{text:"You sneak silently and hide. ü§´",end:true,unlock:"azul_mochkil_pirates.mp4"}
  },
  space:{
    start:{text:"üöÄ A cardboard box turns into a spaceship. What now?",choices:[{label:"Launch!",next:"launch"},{label:"Hack navigation",next:"hack"}]},
    launch:{text:"You launch into the stars! ‚ú®",end:true,unlock:"azul_mochkil_space_voyager.mp4"},
    hack:{text:"Azul hacks the system. üíª",end:true,unlock:"azul_mochkil_space_voyager.mp4"}
  },
  moon:{
    start:{text:"üåå Moon Picnic: what do you do?",choices:[{label:"Enjoy the picnic",next:"picnic"},{label:"Float away",next:"float"}]},
    picnic:{text:"You savor cosmic snacks. ü•™",end:true,unlock:"azul_lori_moon_picnic.mp4"},
    float:{text:"You float into the void. üå†",end:true,unlock:"azul_lori_moon_picnic.mp4"}
  },
  ninja:{
    start:{text:"ü•∑üèª Ninja Farm: what‚Äôs your move?",choices:[{label:"Train as ninja",next:"train"},{label:"Steal carrots",next:"steal"}]},
    train:{text:"You train fiercely. üí™",end:true,unlock:"azul_mochkil_ninja_farm.mp4"},
    steal:{text:"Carrots vanish mysteriously. ü•ï",end:true,unlock:"azul_mochkil_ninja_farm.mp4"}
  },
  hacker:{
    start:{text:"üíª Hacker Competition! Do you join?",choices:[{label:"Hack!",next:"hackStart"},{label:"Ignore",next:"ignore"}]},
    hackStart:{text:"You successfully hack the scammers. üòé",end:true,unlock:"azul_lori_hacker.mp4"},
    ignore:{text:"You ignore it‚Ä¶ maybe next time. ü§î",end:true,unlock:"azul_lori_hacker.mp4"}
  },
  dream:{
    start:{text:"üí§ Mochkil‚Äôs Sweet Dream: what do you do?",choices:[{label:"Enter the dream",next:"enter"},{label:"Wake him",next:"wake"}]},
    enter:{text:"Mochkil enjoys a magical dream. üåô",end:true,unlock:"mochkil_sweet_dream.mp4"},
    wake:{text:"Mochkil wakes and looks confused. üò≥",end:true,unlock:"mochkil_sweet_dream.mp4"}
  },
  nz:{
    start:{text:"üá≥üáø New Zealand Adventure: mountains or beach?",choices:[{label:"Mountains",next:"mountains"},{label:"Beach",next:"beach"}]},
    mountains:{text:"You explore breathtaking peaks. üèîÔ∏è",end:true,unlock:"azul_mochkil_new_zealand.mp4"},
    beach:{text:"You relax on sunny beaches. üèñÔ∏è",end:true,unlock:"azul_mochkil_new_zealand.mp4"}
  }
};

// Add chat responses
function addResponse(){
  const input=document.getElementById('promptInput');
  const responses=document.getElementById('responses');
  if(input.value.trim()==='') return;
  const userPrompt=input.value;
  showTypingIndicator(true);
  setTimeout(()=>{
    showTypingIndicator(false);
    const azulReply=azulReplies[Math.floor(Math.random()*azulReplies.length)];
    const mochkilReply=mochkilReplies[Math.floor(Math.random()*mochkilReplies.length)];
    const div=document.createElement('div');
    div.className='response';
    div.innerHTML=`<strong>You:</strong> ${userPrompt}<br>
    <img src="azul.png" class="character"> <strong>Azul üß™:</strong> ${azulReply}<br>
    <img src="mochkil.png" class="character"> <strong>Mochkil üç™:</strong> ${mochkilReply}`;
    responses.prepend(div);

    // Trigger story if keyword detected
    const keyword=userPrompt.toLowerCase();
    if(keyword.includes('taco')) startStory('taco');
    else if(keyword.includes('pirate')) startStory('pirate');
    else if(keyword.includes('space')) startStory('space');
    else if(keyword.includes('moon')) startStory('moon');
    else if(keyword.includes('ninja')) startStory('ninja');
    else if(keyword.includes('hacker')) startStory('hacker');
    else if(keyword.includes('dream')) startStory('dream');
    else if(keyword.includes('new zealand')) startStory('nz');

    input.value='';
  },1000);
}

// Random prompt
function randomPrompt(){
  const prompt=randomPrompts[Math.floor(Math.random()*randomPrompts.length)];
  document.getElementById('promptInput').value=prompt;
}

// Start story
function startStory(story){
  currentStory=story;
  currentNode='start';
  showStoryNode();
}

// Show story node
function showStoryNode(){
  if(!currentStory) return;
  const node=stories[currentStory][currentNode];
  const responses=document.getElementById('responses');
  const div=document.createElement('div');
  div.className='response';
  div.innerHTML=`<strong>Story:</strong> ${node.text}`;
  responses.prepend(div);

  if(node.end){
    unlockVideo(node.unlock);
    currentStory=null;
    currentNode=null;
  }else{
    const btnContainer=document.createElement('div');
    node.choices.forEach(choice=>{
      const btn=document.createElement('button');
      btn.textContent=choice.label;
      btn.onclick=()=>{currentNode=choice.next;showStoryNode();btnContainer.remove();}
      btnContainer.appendChild(btn);
    });
    responses.prepend(btnContainer);
  }
}

// Unlock video with subtitles where needed
function unlockVideo(src){
  const video=document.createElement('video');
  video.controls=true;
  video.style.display='block';
  const sourceElem=document.createElement('source');
  sourceElem.src=src;
  sourceElem.type='video/mp4';
  video.appendChild(sourceElem);

  // Attach subtitles
  if(src.includes("taco_truck") || src.includes("pirates") || src.includes("space_voyager") || src.includes("moon_picnic") || src.includes("ninja_farm") || src.includes("hacker")){
    const track=document.createElement('track');
    track.kind='subtitles';
    track.label='Espa√±ol / English';
    track.srclang='en';
    track.src=src.replace('.mp4','.vtt'); // assumes .vtt file has same base name
    track.default=true;
    video.appendChild(track);
  }

  videosContainer.appendChild(video);
  video.play().catch(()=>{});
  if(navigator.vibrate) navigator.vibrate(100);
}
</script>

</body>
</html>
