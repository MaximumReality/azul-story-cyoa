<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Maximum Reality ‚Äì Azul & Mochkil</title>

<style>
@import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');

body {
  font-family: 'Press Start 2P', monospace;
  background: linear-gradient(to bottom, #070707, #111);
  color: #f0f0f0;
  margin: 0;
  padding: 2rem;
  min-height: 100vh;
}

h1 {
  text-align: center;
  color: #39ff14;
  text-shadow: 0 0 10px #39ff14;
}

p {
  text-align: center;
  color: #aaa;
}

#chatContainer {
  max-width: 720px;
  margin: auto;
}

input {
  width: 100%;
  padding: .6rem;
  border-radius: 6px;
  border: none;
}

button {
  margin-top: .5rem;
  padding: .5rem 1rem;
  background: #111;
  color: #39ff14;
  border: 2px solid #39ff14;
  border-radius: 6px;
  cursor: pointer;
}

button:hover {
  background: #39ff14;
  color: #000;
}

#responses {
  display: flex;
  flex-direction: column-reverse;
  gap: 1rem;
  margin-top: 1rem;
}

.response {
  background: #111;
  padding: 1rem;
  border-radius: 10px;
  box-shadow: 0 0 10px #39ff14;
  animation: fadeIn .4s;
}

img.character {
  width: 40px;
  margin-right: .4rem;
  animation: bounceIn .6s;
}

.storyButtons {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: .5rem;
  margin-top: 1rem;
}

video {
  display: block;
  margin: 1rem auto;
  max-width: 90%;
  border: 3px solid #39ff14;
  border-radius: 10px;
  box-shadow: 0 0 20px #39ff14;
}

#typingIndicator {
  text-align: center;
  color: #39ff14;
  display: none;
}

.floating {
  position: fixed;
  font-size: 3rem;
  pointer-events: none;
  transition: all 2s ease;
}

.confetti {
  position: fixed;
  width: 8px;
  height: 8px;
  border-radius: 50%;
  animation: fall 2s linear forwards;
  z-index: 9999;
}

@keyframes bounceIn {
  0% { transform: scale(.3) translateY(-40px); opacity: 0 }
  60% { transform: scale(1.05) translateY(10px) }
  100% { transform: scale(1); opacity: 1 }
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px) }
  to { opacity: 1; transform: translateY(0) }
}

@keyframes fall {
  from { transform: translateY(0); opacity: 1 }
  to { transform: translateY(100vh); opacity: 0 }
}
</style>
</head>

<body>

<h1>Chat with Azul & Mochkil üê±üêà‚Äç‚¨õ</h1>
<p>Type freely ‚Äî or unlock adventures through your choices.</p>

<div id="chatContainer">
  <input id="prompt" placeholder="Type a prompt or say pirate, taco, space..." />
  <button onclick="send()">Send</button>
  <div id="typingIndicator">üí¨ Azul & Mochkil are thinking...</div>
</div>

<div id="responses"></div>
<div class="storyButtons" id="choices"></div>

<script>
const responses = document.getElementById("responses");
const choicesDiv = document.getElementById("choices");
const typing = document.getElementById("typingIndicator");

const azulReplies = [
  "Floating again üåÄ",
  "Maximum Reality engaged üß™",
  "I warned you this would get weird üòé"
];

const mochkilReplies = [
  "SNACKS üç™",
  "Oops üò∫",
  "Adventure!!!"
];

// ---------- STORIES ----------
const stories = {
pirate: {
  intro:{text:"A pirate ship appears. Board or sneak aboard?",
    choices:[
      {text:"Board proudly",next:"deck"},
      {text:"Sneak below",next:"cargo"}
    ]},
  deck:{text:"Cannons fire! Fight or steer?",
    choices:[
      {text:"Fight pirates",next:"end"},
      {text:"Steer ship",next:"end"}
    ]},
  cargo:{text:"Treasure room found!",
    choices:[
      {text:"Open chest",next:"end"},
      {text:"Hide inside",next:"end"}
    ]},
  end:{text:"You sail into legend.",end:true,
    video:"azul_mochkil_pirates.mp4",
    vtt:"azul_mochkil_pirates.vtt",
    emoji:"üè¥‚Äç‚ò†Ô∏è"}
},

space:{
  intro:{text:"Launch into space or hack navigation?",
    choices:[
      {text:"Launch",next:"orbit"},
      {text:"Hack ship",next:"orbit"}
    ]},
  orbit:{text:"Aliens detected!",
    choices:[
      {text:"Say hi",next:"end"},
      {text:"Hide",next:"end"}
    ]},
  end:{text:"Cosmic success!",end:true,
    video:"azul_mochkil_space_voyager.mp4",
    vtt:"azul_mochkil_space_voyager.vtt",
    emoji:"üöÄ"}
},

taco:{
  intro:{text:"A taco truck appears. Approach?",
    choices:[
      {text:"Order politely",next:"order"},
      {text:"Sneak taco",next:"order"}
    ]},
  order:{text:"Azul insists on Spanish.",
    choices:[
      {text:"Try anyway",next:"end"},
      {text:"Let Mochkil order",next:"end"}
    ]},
  end:{text:"üåÆ Tacos unlocked!",end:true,
    video:"azul_mochkil_taco_truck.mp4",
    vtt:[
      {src:"azul_mochkil_taco_truck.vtt",lang:"es",label:"Espa√±ol",default:true},
      {src:"azul_mochkil_taco_truck_en.vtt",lang:"en",label:"English"}
    ],
    emoji:"üåÆ"}
},

moon:{
  intro:{text:"Picnic on the moon?",
    choices:[
      {text:"Yes",next:"end"},
      {text:"Float away",next:"end"}
    ]},
  end:{text:"Moon picnic complete üåô",end:true,
    video:"azul_lori_moon_picnic.mp4",
    vtt:"azul_lori_moon_picnic.vtt",
    emoji:"üåô"}
},

ninja:{
  intro:{text:"Train ninja cats?",
    choices:[
      {text:"Yes",next:"end"},
      {text:"Steal carrots",next:"end"}
    ]},
  end:{text:"Ninja farm chaos!",end:true,
    video:"azul_mochkil_ninja_farm.mp4",
    vtt:"azul_mochkil_ninja_farm.vtt",
    emoji:"ü•∑"}
},

hacker:{
  intro:{text:"Scammer call detected.",
    choices:[
      {text:"Hack",next:"end"},
      {text:"Ignore",next:"end"}
    ]},
  end:{text:"Scammers defeated.",end:true,
    video:"azul_lori_hacker.mp4",
    vtt:"azul_lori_hacker.vtt",
    emoji:"üíª"}
},

dream:{
  intro:{text:"Mochkil is dreaming.",
    choices:[
      {text:"Enter dream",next:"end"},
      {text:"Wake him",next:"end"}
    ]},
  end:{text:"Sweet dreams üç™",end:true,
    video:"mochkil_sweet_dream.mp4",
    emoji:"üò¥"}
},

newzealand:{
  intro:{text:"Explore New Zealand?",
    choices:[
      {text:"Mountains",next:"end"},
      {text:"Beach",next:"end"}
    ]},
  end:{text:"Adventure complete!",end:true,
    video:"azul_mochkil_new_zealand.mp4",
    emoji:"üó∫Ô∏è"}
}
};

// ---------- FUNCTIONS ----------
function send(){
  const input=document.getElementById("prompt");
  if(!input.value) return;
  typing.style.display="block";

  setTimeout(()=>{
    typing.style.display="none";
    addBubble("You",input.value);
    addBubble("Azul üß™",random(azulReplies),"azul.png");
    addBubble("Mochkil üç™",random(mochkilReplies),"mochkil.png");
    checkStory(input.value.toLowerCase());
    input.value="";
  },700);
}

function addBubble(name,text,img){
  const d=document.createElement("div");
  d.className="response";
  d.innerHTML=(img?`<img src="${img}" class="character">`:"")+`<strong>${name}:</strong> ${text}`;
  responses.prepend(d);
}

function random(arr){return arr[Math.floor(Math.random()*arr.length)]}

function checkStory(text){
  for(const key in stories){
    if(text.includes(key)){
      startStory(key);
      return;
    }
  }
}

function startStory(key){
  choicesDiv.innerHTML="";
  showNode(stories[key].intro,key);
}

function showNode(node,key){
  addBubble("Story",node.text);
  if(node.end){
    unlock(node);
  } else {
    choicesDiv.innerHTML="";
    node.choices.forEach(c=>{
      const b=document.createElement("button");
      b.textContent=c.text;
      b.onclick=()=>showNode(stories[key][c.next],key);
      choicesDiv.appendChild(b);
    });
  }
}

function unlock(node){
  confetti();
  floatEmoji(node.emoji);
  if(navigator.vibrate) navigator.vibrate(200);
  const v=document.createElement("video");
  v.controls=true;
  v.innerHTML=`<source src="${node.video}" type="video/mp4">`;
  if(Array.isArray(node.vtt)){
    node.vtt.forEach(t=>{
      const tr=document.createElement("track");
      tr.kind="subtitles";
      tr.src=t.src;
      tr.srclang=t.lang;
      tr.label=t.label;
      if(t.default) tr.default=true;
      v.appendChild(tr);
    });
  } else if(node.vtt){
    v.innerHTML+=`<track kind="subtitles" src="${node.vtt}" default>`;
  }
  document.body.appendChild(v);
}

function floatEmoji(e){
  const f=document.createElement("div");
  f.className="floating";
  f.textContent=e+"üéâ";
  f.style.left="50%";
  f.style.top="50%";
  document.body.appendChild(f);
  setTimeout(()=>{f.style.top="20%";f.style.opacity=0},50);
  setTimeout(()=>f.remove(),2000);
}

function confetti(){
  for(let i=0;i<40;i++){
    const c=document.createElement("div");
    c.className="confetti";
    c.style.background=`hsl(${Math.random()*360},100%,50%)`;
    c.style.left=Math.random()*window.innerWidth+"px";
    c.style.top="-10px";
    document.body.appendChild(c);
    setTimeout(()=>c.remove(),2000);
  }
}
</script>
</body>
</html>
