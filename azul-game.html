<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Chat with Azul & Mochkil üê±üêà‚Äç‚¨õ</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');

body {
  font-family:'Press Start 2P', monospace;
  background: #0a0a0a; /* dark base */
  background-image: 
    repeating-linear-gradient(
      0deg,
      rgba(255,255,255,0.02) 0,
      rgba(255,255,255,0.02) 1px,
      transparent 1px,
      transparent 3px
    ),
    repeating-linear-gradient(
      90deg,
      rgba(255,255,255,0.01) 0,
      rgba(255,255,255,0.01) 1px,
      transparent 1px,
      transparent 3px
    );
  color:#f0f0f0;
  padding:2rem;
  margin:0;
  min-height:100vh;
}

h1 {
  color:#39ff14;
  text-shadow:0 0 10px #39ff14;
  text-align:center;
  margin-bottom:0.5rem;
  font-size:2rem;
}

p {
  text-align:center;
  color:#aaa;
  margin-bottom:2rem;
  font-size:1rem;
}

#chatContainer {
  max-width:700px;
  margin:0 auto 2rem;
  display:flex;
  flex-direction:column;
  gap:1rem;
  background: rgba(0,0,0,0.4);
  padding:1rem;
  border-radius:10px;
}

input[type="text"] {
  font-family:monospace;
  font-size:1rem;
  padding:0.5rem;
  border-radius:5px;
  border:none;
  width:100%;
  box-sizing:border-box;
}

button {
  font-family:monospace;
  font-size:1rem;
  padding:0.5rem 1rem;
  margin-top:0.5rem;
  background:#222;
  color:#39ff14;
  border:2px solid #39ff14;
  border-radius:5px;
  cursor:pointer;
  transition:0.2s;
}

button:hover {
  background:#39ff14;
  color:#000;
}

#responses {
  margin-top:1rem;
  display:flex;
  flex-direction:column-reverse;
  gap:1rem;
  background: rgba(0,0,0,0.2);
  padding:1rem;
  border-radius:10px;
}

.response {
  padding:0.5rem 1rem;
  border-radius:10px;
  background:rgba(17,17,17,0.8);
  box-shadow:0 0 10px #39ff14, 0 0 20px #ff00ff;
  animation:fadeIn 0.5s;
}

.response strong {
  color:#39ff14;
  text-shadow: 0 0 5px #ff00ff;
}

img.character {
  width:60px;
  vertical-align:middle;
  margin-right:0.5rem;
  border:2px solid #39ff14;
  border-radius:50%;
  box-shadow:0 0 10px #ff00ff;
}

#typingIndicator {
  text-align:center;
  font-style:italic;
  color:#39ff14;
  display:none;
}

video {
  display:none;
  margin:1rem auto;
  max-width:70%;
  border:3px solid #39ff14;
  border-radius:10px;
  box-shadow:0 0 20px #ff00ff, 0 0 10px #39ff14;
  animation:videoGlow 2s infinite alternate;
}

/* Animations */
@keyframes fadeIn {
  from {opacity:0; transform:translateY(10px);}
  to {opacity:1; transform:translateY(0);}
}

@keyframes videoGlow {
  0% {box-shadow:0 0 10px #39ff14, 0 0 20px #ff00ff;}
  50% {box-shadow:0 0 20px #39ff14, 0 0 30px #ff00ff;}
  100% {box-shadow:0 0 10px #39ff14, 0 0 20px #ff00ff;}
}

body::before {
  content:"üêæ";
  position:fixed;
  font-size:3rem;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%) rotate(45deg);
  opacity:0.03;
  pointer-events:none;
}
</style>
</head>
<body>

<h1>Chat with Azul & Mochkil üê±üêà‚Äç‚¨õ</h1>
<p>Ask a question or start an adventure!</p>

<div id="chatContainer">
  <input type="text" id="promptInput" placeholder="Type your story prompt here...">
  <div>
    <button onclick="addResponse()">Send</button>
    <button onclick="randomPrompt()">üé≤ Random Prompt</button>
  </div>
  <div id="typingIndicator">üí¨ Azul & Mochkil are thinking...</div>
</div>

<div id="responses"></div>

<h2>Unlocked Adventures</h2>
<div id="videosContainer"></div>

<script>
// Character replies
const azulReplies = [
  "Oh, sure‚Ä¶ like I haven‚Äôt seen this before üòè",
  "Adventure calls! Hope you can keep up üöÄ",
  "Sarcastic comment loaded‚Ä¶ but I‚Äôll save it for the dramatic moment üòé",
  "Hacking the scammers again‚Ä¶ you‚Äôre welcome üíª",
  "Floating upside-down because walking is boring üåÄ",
  "Keep your eyes peeled ‚Äî surprises ahead ‚ú®",
  "Bet you didn‚Äôt expect THAT in Maximum Reality! üß™"
];

const mochkilReplies = [
  "Is it snack time yet? üç™",
  "I‚Äôll eat everything in sight‚Ä¶ maybe later üòã",
  "Bored‚Ä¶ let‚Äôs play ninjas! ü•∑üèª",
  "Oops! Did I break something again? üôÉ",
  "Food‚Ä¶ everywhere‚Ä¶ my dream world üç©",
  "Can I eat that? Can I? Can I? üêü",
  "Wait‚Ä¶ what are we doing? Oh cool! üêæ"
];

const randomPrompts = [
  "What is Mochkil dreaming today? üç™",
  "What hack is Azul working on? üß™",
  "What's happening in Maximum Reality right now? üåå",
  "Pirates Adventure! üè¥‚Äç‚ò†Ô∏è",
  "Space voyage time! üöÄ"
];

// Typing indicator
const typingIndicator = document.getElementById('typingIndicator');
let typingInterval;
function showTypingIndicator(show){
  if(show){
    typingIndicator.style.display='block';
    let visible=true;
    typingInterval=setInterval(()=>{typingIndicator.style.opacity=visible?'1':'0.3'; visible=!visible;},500);
  } else {
    typingIndicator.style.display='none';
    clearInterval(typingInterval);
  }
}

// Story state
let storyProgress=null;
let questionIndex=0;
const videosContainer = document.getElementById('videosContainer');

// Stories
const stories = {
  taco:{/*... same as previous ...*/},
  pirate:{/*... same as previous ...*/},
  space:{/*... same as previous ...*/},
  moon:{/*... same as previous ...*/},
  hacker:{/*... same as previous ...*/},
  drAzul:{
    title:"Visit to Dr. Azul üß™üè•",
    questions:[
      {q:"Mochkil says, 'My belly hurts!' What should he do?",a:["Apologize for eating too much","Hide under the chair","Eat more snacks"],branchVideos:[null,null,"birthday_cake.mp4"]},
      {q:"Dr. Azul sighs and starts typing. What do you do?",a:["Ask for a prescription","Float upside-down for fun","Watch quietly"],branchVideos:[null,null,null]},
      {q:"Mochkil notices a floating beaker. What should he do?",a:["Touch it","Ignore it","Ask Azul about it"],branchVideos:[null,null,null]},
      {q:"Dr. Azul looks at Mochkil. How should he respond?",a:["Calm explanation","Weary sigh","Throw confetti"],branchVideos:[null,null,null]},
      {q:"Mochkil is curious about Azul's files. What next?",a:["Peek at files","Ask politely","Float around the room"],branchVideos:[null,null,null]},
      {q:"Time to leave the office. Where to next?",a:["Forest adventure","Lab experiment","Nap time"],branchVideos:[null,null,null]}
    ],
    video:"dr_azul.mp4",
    vtt:""
  },
  treasureCave:{
    title:"Treasure Cave Adventure üèîÔ∏èüí∞",
    questions:[
      {q:"You enter a dark cave. What do you do first?",a:["Light a torch","Shout to see if anyone is there","Tiptoe quietly"],branchVideos:[null,null,null]},
      {q:"You hear a dripping sound. Investigate?",a:["Yes, follow it","No, keep going straight","Sit and listen"],branchVideos:[null,null,null]},
      {q:"A narrow passage appears. How do you proceed?",a:["Crawl through","Jump over it","Turn back"],branchVideos:[null,null,null]},
      {q:"You smell something shiny. Check it?",a:["Yes, inspect closely","Ignore it","Mark the spot on your map"],branchVideos:[null,null,null]},
      {q:"A mysterious glimmer is ahead. Approach carefully?",a:["Yes, sneak forward","Run toward it","Call Azul for advice"],branchVideos:[null,null,null]},
      {q:"You turn the corner‚Ä¶ what do you see?",a:["A huge treasure chamber!","Just more rocks","A hidden passage"],branchVideos:[null,null,null]}
    ],
    video:"treasure_cave.mp4",
    vtt:""
  }
};

// Add chat responses
function addResponse(){
  const input = document.getElementById('promptInput');
  if(input.value.trim()==='') return;
  const userPrompt = input.value;
  showTypingIndicator(true);
  setTimeout(()=>{
    showTypingIndicator(false);
    const azulReply = azulReplies[Math.floor(Math.random()*azulReplies.length)];
    const mochkilReply = mochkilReplies[Math.floor(Math.random()*mochkilReplies.length)];
    const div = document.createElement('div');
    div.className='response';
    div.innerHTML=`<strong>You:</strong> ${userPrompt}<br>
    <img src="azul.png" class="character"> <strong>Azul üß™:</strong> ${azulReply}<br>
    <img src="mochkil.png" class="character"> <strong>Mochkil üç™:</strong> ${mochkilReply}`;
    document.getElementById('responses').prepend(div);

    const keyword = userPrompt.toLowerCase();
    for(const key in stories){
      if(keyword.includes(key)){
        startStory(key);
        break;
      }
    }
    input.value='';
  },1000);
}

function randomPrompt(){
  const prompt = randomPrompts[Math.floor(Math.random()*randomPrompts.length)];
  document.getElementById('promptInput').value = prompt;
}

function startStory(storyKey){
  storyProgress = storyKey;
  questionIndex = 0;
  showNextQuestion();
}

function showNextQuestion(){
  if(!storyProgress) return;
  const story = stories[storyProgress];
  if(questionIndex >= story.questions.length){
    unlockVideo(story.video);
    storyProgress=null;
    return;
  }
  const q = story.questions[questionIndex];
  const div = document.createElement('div');
  div.className='response';
  div.innerHTML=`<strong>Question ${questionIndex+1}:</strong> ${q.q}`;
  const btnContainer = document.createElement('div');
  q.a.forEach((ans,i)=>{
    const btn = document.createElement('button');
    btn.textContent = ans;
    btn.onclick = ()=>{
      if(q.branchVideos && q.branchVideos[i]){
        unlockVideo(q.branchVideos[i]);
        storyProgress=null;
      } else {
        questionIndex++;
        btnContainer.remove();
        showNextQuestion();
      }
    }
    btnContainer.appendChild(btn);
  });
  div.appendChild(btnContainer);
  document.getElementById('responses').prepend(div);
}

function unlockVideo(src){
  const video = document.createElement('video');
  video.controls=true;
  video.style.display='block';
  const sourceElem=document.createElement('source');
  sourceElem.src=src;
  sourceElem.type='video/mp4';
  video.appendChild(sourceElem);
  document.getElementById('videosContainer').appendChild(video);
  video.play().catch(()=>{});
  if(navigator.vibrate) navigator.vibrate(100);
}
</script>
</body>
</html>
